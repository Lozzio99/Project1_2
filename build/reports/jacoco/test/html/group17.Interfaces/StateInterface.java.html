<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>StateInterface.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Project_1.2</a> &gt; <a href="index.source.html" class="el_package">group17.Interfaces</a> &gt; <span class="el_source">StateInterface.java</span></div><h1>StateInterface.java</h1><pre class="source lang-java linenums">package group17.Interfaces;

import group17.Math.Lib.Vector3D;
import group17.Simulation.System.Bodies.CelestialBody;
import group17.Simulation.System.State.SystemState;

import java.util.List;

/**
 * An interface representing the state of a system described by a differential equation.
 */
public interface StateInterface {

    /**
     * Copy state interface.
     *
     * @return the state interface
     */
    default StateInterface copy() {
<span class="nc" id="L20">        StateInterface s = new SystemState();</span>
<span class="nc bnc" id="L21" title="All 2 branches missed.">        for (int i = 0; i &lt; this.getPositions().size(); i++) {</span>
<span class="nc" id="L22">            s.getPositions().add(this.getPositions().get(i).clone());</span>
<span class="nc" id="L23">            s.getRateOfChange().getVelocities().add(this.getRateOfChange().getVelocities().get(i).clone());</span>
        }
<span class="nc" id="L25">        return s;</span>
    }

    String toString();

    /**
     * Gets rate of change.
     *
     * @return the rate of change
     */
    RateInterface getRateOfChange();

    /**
     * The state of the bodies at a given point in time
     *
     * @return the positions of all bodies in the state
     */
    List&lt;Vector3dInterface&gt; getPositions();

    /**
     * Sets positions.
     *
     * @param v the v
     */
    void setPositions(List&lt;Vector3dInterface&gt; v);

    /**
     * Initialises the system state to be the initial value at the launch day
     *
     * @param bodies the bodies
     * @return the StateInterface y(0)
     */
    default StateInterface state0(List&lt;CelestialBody&gt; bodies) {
<span class="nc" id="L58">        StateInterface state = this;</span>
<span class="nc bnc" id="L59" title="All 2 branches missed.">        for (CelestialBody b : bodies) {</span>
<span class="nc" id="L60">            b.initProperties();</span>
<span class="nc" id="L61">            state.getPositions().add(b.getVectorLocation().clone());</span>
<span class="nc" id="L62">            state.getRateOfChange().getVelocities().add(b.getVectorVelocity().clone());</span>
<span class="nc" id="L63">        }</span>
<span class="nc" id="L64">        return state;</span>
    }

    /**
     * Update a state to a new state computed by: this + step * rate
     *
     * @param step The time-step of the update
     * @param rate The average rate-of-change over the time-step. Has dimensions of [state]/[time].
     * @return The new state after the update. Required to have the same class as 'this'.
     */
    default StateInterface addMul(double step, RateInterface rate) {
<span class="nc" id="L75">        StateInterface newState = new SystemState();</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">        for (int i = 0; i &lt; this.getPositions().size(); i++) {</span>
<span class="nc" id="L77">            newState.getPositions().add(this.getPositions().get(i).addMul(step, rate.getVelocities().get(i)));</span>
<span class="nc" id="L78">            newState.getRateOfChange().getVelocities().add(rate.getVelocities().get(i).clone());</span>
        }
<span class="nc" id="L80">        return newState;</span>
    }


    /**
     * Rate mul state interface.
     *
     * @param step the step
     * @param rate the rate
     * @return new state based on step*Rate
     */
    default StateInterface rateMul(double step, RateInterface rate) { //!!
<span class="nc" id="L92">        StateInterface newState = new SystemState();</span>
<span class="nc bnc" id="L93" title="All 2 branches missed.">        for (int i = 0; i &lt; this.getPositions().size(); i++) {</span>
<span class="nc" id="L94">            newState.getPositions().add(rate.getVelocities().get(i).mul(step));</span>
<span class="nc" id="L95">            newState.getRateOfChange().getVelocities().add(new Vector3D(0, 0, 0));</span>
        }
<span class="nc" id="L97">        return newState;</span>
    }


    /**
     * Multiply state interface.
     *
     * @param scalar the scalar
     * @return the state interface
     */
    default StateInterface multiply(double scalar) {
<span class="nc bnc" id="L108" title="All 2 branches missed.">        if (this.getPositions().size() == 0)</span>
<span class="nc" id="L109">            throw new RuntimeException(&quot; Nothing to multiply &quot;);</span>
<span class="nc" id="L110">        StateInterface state = new SystemState();</span>
<span class="nc bnc" id="L111" title="All 2 branches missed.">        for (int i = 0; i &lt; this.getPositions().size(); i++) {</span>
<span class="nc" id="L112">            state.getPositions().add(this.getPositions().get(i).mul(scalar));</span>
<span class="nc" id="L113">            state.getRateOfChange().getVelocities().add(this.getRateOfChange().getVelocities().get(i).mul(scalar));</span>
        }
<span class="nc" id="L115">        return state;</span>
    }

    /**
     * Div state interface.
     *
     * @param scalar the scalar
     * @return the state interface
     */
    default StateInterface div(double scalar) {
<span class="nc bnc" id="L125" title="All 2 branches missed.">        if (this.getPositions().size() == 0)</span>
<span class="nc" id="L126">            throw new RuntimeException(&quot; Nothing to divide &quot;);</span>

<span class="nc" id="L128">        StateInterface state = new SystemState();</span>
<span class="nc bnc" id="L129" title="All 2 branches missed.">        for (int i = 0; i &lt; this.getPositions().size(); i++) {</span>
<span class="nc" id="L130">            state.getPositions().add(this.getPositions().get(i).div(scalar));</span>
<span class="nc" id="L131">            state.getRateOfChange().getVelocities().add(this.getRateOfChange().getVelocities().get(i).div(scalar));</span>
        }
<span class="nc" id="L133">        return state;</span>
    }
    default StateInterface divBy(double scalar) {
<span class="nc bnc" id="L136" title="All 2 branches missed.">        if (this.getPositions().size() == 0)</span>
<span class="nc" id="L137">            throw new RuntimeException(&quot; Nothing to divide &quot;);</span>

<span class="nc" id="L139">        StateInterface state = new SystemState();</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">        for (int i = 0; i &lt; this.getPositions().size(); i++) {</span>
<span class="nc" id="L141">            state.getPositions().add(this.getPositions().get(i).div(scalar));</span>
         //   state.getRateOfChange().getVelocities().add(this.getRateOfChange().getVelocities().get(i).div(scalar));
        }
<span class="nc" id="L144">        return state;</span>
    }

    /**
     * Add state interface.
     *
     * @param tobeAdded the tobe added
     * @return the state interface
     */
    default StateInterface add(StateInterface tobeAdded) {
<span class="nc bnc" id="L154" title="All 2 branches missed.">        if (this.getPositions().size() == 0)</span>
<span class="nc" id="L155">            throw new RuntimeException(&quot; Nothing to add &quot;);</span>
<span class="nc" id="L156">        StateInterface state = new SystemState();</span>

<span class="nc bnc" id="L158" title="All 2 branches missed.">        for (int i = 0; i &lt; this.getPositions().size(); i++) {</span>
<span class="nc" id="L159">            state.getPositions().add(this.getPositions().get(i).add(tobeAdded.getPositions().get(i)));</span>
<span class="nc" id="L160">            state.getRateOfChange().getVelocities().add(this.getRateOfChange().getVelocities().get(i).add(tobeAdded.getRateOfChange().getVelocities().get(i)));</span>
        }
<span class="nc" id="L162">        return state;</span>
    }

    /**
     * Sum of state interface.
     * Used for Rk4 Solver
     * kk/6 = k1+2*k2+2*k3+k4'
     *
     * @param rates the rates
     * @return the state interface
     */
    default StateInterface sumOf(StateInterface... rates) {
<span class="nc" id="L174">        StateInterface state = new SystemState();</span>
<span class="nc bnc" id="L175" title="All 2 branches missed.">        for (int i = 0; i &lt; rates[0].getPositions().size(); i++) {</span>
<span class="nc" id="L176">            Vector3dInterface sum = this.getPositions().get(i);</span>
<span class="nc" id="L177">            Vector3dInterface velsum = this.getRateOfChange().getVelocities().get(i);</span>
<span class="nc bnc" id="L178" title="All 2 branches missed.">            for (StateInterface r : rates) {</span>
<span class="nc" id="L179">                sum = sum.add(r.getPositions().get(i));</span>
<span class="nc" id="L180">                velsum = velsum.add(r.getRateOfChange().getVelocities().get(i));</span>
            }
<span class="nc" id="L182">            state.getPositions().add(sum);</span>
<span class="nc" id="L183">            state.getRateOfChange().getVelocities().add(velsum);</span>
        }
<span class="nc" id="L185">        return state;</span>
    }

    /**
     * Update.
     *
     * @param step the step
     */
    default void update(StateInterface step) {
<span class="nc" id="L194">        this.setPositions(step.getPositions());</span>
<span class="nc" id="L195">        this.getRateOfChange().setVelocities(step.getRateOfChange().getVelocities());</span>
<span class="nc" id="L196">    }</span>

    @Override
    int hashCode();

    void setRateOfChange(RateInterface newRate);

    default StateInterface getState(RateInterface rate) {
<span class="nc" id="L204">        StateInterface state = new SystemState();</span>
<span class="nc bnc" id="L205" title="All 2 branches missed.">        for (int i = 0; i &lt; rate.getVelocities().size(); i++) {</span>
<span class="nc" id="L206">            state.getPositions().add(rate.getVelocities().get(i));</span>
        }
<span class="nc" id="L208">        return state;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>